<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<title>新增公司</title> <%includeFileTemplate("/html/dumCommon.html"){
%><%}%>
<link type="text/css" rel="stylesheet" href="${ctxPath}/css/userClient/nav_userClient.css">
<link type="text/css" rel="stylesheet" href="${ctxPath}/css/userClient/recommend.css">
<link rel="stylesheet" type="text/css" href="${ctxPath}/js/easyui/themes/gray/easyui.css">
<link rel="stylesheet" type="text/css" href="${ctxPath}/js/easyui/themes/icon.css">
<script type="text/javascript" src="${ctxPath}/js/easyui/jquery.easyui.min.js"></script>
<style type="text/css">
	#cusEnterpriseInfoTable tr{
		height:40px;
	}
</style>
<script type="text/javascript">

function myformatter(date){
	var y = date.getFullYear();
	var m = date.getMonth()+1;
	var d = date.getDate();
	return y+'-'+(m<10?('0'+m):m)+'-'+(d<10?('0'+d):d);
}
function myparser(s){
	if (!s) return new Date();
	var ss = (s.split('-'));
	var y = parseInt(ss[0],10);
	var m = parseInt(ss[1],10);
	var d = parseInt(ss[2],10);
	if (!isNaN(y) && !isNaN(m) && !isNaN(d)){
		return new Date(y,m-1,d);
	} else {
		return new Date();
	}
}

/**
 * 保存公司信息
 */
function saveCusEnterprise()
{
	var form=$("#cusEnterpriseInfoForm");
	var url ="/cusEnterprise/saveCusEnterprise";
	var param=form.serialize();
	dum.common.ajax({
		type : 'post',
		url : url+'.api',
		dataType : 'json',
		data:param,
		async : false,
		success : function(data) {
			window.location.href="${ctxPath}/myCompany/myEnterprise.html";	
		}
	});
}

$(function() {
    // 下拉框选择控件，下拉框的内容是动态查询数据库信息  
    $('#selectCity').combobox({   
            url:'${ctxPath}/sysarea/areaList/2.html',   
            editable:false, //不可编辑状态  
            cache: false,  
            panelHeight: '150',  
            valueField:'id',     
            textField:'areaName',  
              
      onHidePanel: function(){  
          $("#selectRegion").combobox("setValue",'');
          var id = $('#selectCity').combobox('getValue');          
          if(id){
        	  $.ajax({  
    	          type: "get",  
    	          url: '${ctxPath}/sysarea/areasListByParent/'+id+'.html',  
    	          cache: false,  
    	          dataType : "json",  
    	          success: function(data){  
    	         	$("#selectRegion").combobox("loadData",data);  
    	          }  
    	        });    
          }      
        }  
	});      
      
    $('#selectRegion').combobox({   
        editable:false, //不可编辑状态  
        cache: false,  
        panelHeight: '150',//自动高度适合  
        valueField:'id',     
        textField:'areaName'  
     });
    
    var areaparentid = $('#areaparentid').val();
    if(areaparentid){
    	$("#selectCity").combobox("setValue",areaparentid);
    }
    var areaidid = $('#areaidid').val();
    if(areaidid){
    	 $('#selectRegion').combobox({   
             url:'${ctxPath}/sysarea/areaList/3.html',   
             editable:false, //不可编辑状态  
             cache: false,  
             panelHeight: '150',  
             valueField:'id',     
             textField:'areaName'
    	 });
    	$("#selectRegion").combobox("setValue",areaidid);
    }
    
});
</script>
<script language=javascript
	src="${ctxPath}/js/userClient/myrecommend.js"></script>
</head>
<body>
	<%includeFileTemplate("/html/nav_temp.html"){ %><%}%>
	<%includeFileTemplate("/html/userClientCommon.html"){ %><%}%>
	<div class="w_1160 wrap clearfix">
		<div id="nav_left" class="nav_left border_right">
			<%includeFileTemplate("/html/userClient_navleft.html"){ %><%}%></div>
		<div id="content">
			<div class="clientRight">
				<div class="baseMargin">
					<h4 class="infoTit">
						<span>公司信息</span>
					</h4>
					<div class="easyui-tabs" style="width:100%;height:800px;margin-top: 20px;">
						<div title="基本信息" style="padding:10px">
							<div id="p" class="easyui-panel" title="基本信息" style="width:100%;height:100%;padding:10px;">
								<form id="cusEnterpriseInfoForm" post="post" novalidate="novalidate">
									<table id="cusEnterpriseInfoTable" style="width: 100%">
										
										<tbody><tr>
											<input type="hidden" id="customerId" value="${currentuser.id!}" name="customerId">
											<td width="20%" class="tableleft">公司名称</td>
											<td><input name="id" type="hidden" value="" id="companyId"> 
											<input type="text" name="name" value="" class="easyui-textbox" id="companyName"></td>
											<td width="20%" class="tableleft">公司性质</td>
											<td><select class="easyui-combobox" name="nature" data-options="editable:false" style="width:150px;">
												<option selected value="0">一般纳税人</option>
												<option  value="1">小规模纳税人</option>
											</select></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">公司电话</td>
											<td><input type="text" name="phone" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">公司邮箱</td>
											<td><input type="text" name="email" value="" class="easyui-textbox"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">地址区域</td>
											<td>
												<input id="areaparentid" value="" type="hidden">
												<input id="areaidid" value="" type="hidden">
												<input class="easyui-combobox"  style="width:30%;"  id="selectCity" data-options="editable:false"> 
												<input class="easyui-combobox"  style="width:30%;"  id="selectRegion" name="areaId" data-options="editable:false"> 
											</td>
											<td width="20%" class="tableleft">公司地址</td>
											<td><input type="text" name="address" value="" class="easyui-textbox"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">统一信用代码</td>
											<td><input type="hidden" name="cusEnterpriseExt.id" value="" id="cusEnterpriseExtId"> 
											<input type="text" name="cusEnterpriseExt.companyCode" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">工商注册号</td>
											<td><input type="text" name="cusEnterpriseExt.companyRegOn" value="" class="easyui-textbox"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">组织机构代码</td>
											<td><input type="text" name="cusEnterpriseExt.companyRealCode" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">经营状态</td>
											<td><select class="easyui-combobox" name="cusEnterpriseExt.companyManagementForms" data-options="editable:false" style="width:150px;">
													<option selected value="0">登记成立</option>
													<option value="1">开业</option>
													<option value="2">续存</option>
													<option value="3">注销</option>
													<option value="4">吊销</option>
											</select></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">公司类型</td>
											<td><input type="text" name="cusEnterpriseExt.companyType" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">成立日期</td>
											<td><input class="easyui-datebox" value="" name="cusEnterpriseExt.companyEstablishDate" placeholder="YYYY-MM-DD" data-options="formatter:myformatter,parser:myparser"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">法人名称</td>
											<td><input type="text" name="cusEnterpriseExt.companyLegalPerson" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">法人证件号码</td>
											<td><input type="text" name="cusEnterpriseExt.companyCertificates" value="" class="easyui-textbox"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">注册资本</td>
											<td><input type="number" name="cusEnterpriseExt.companyRegCapital" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">币种</td>
											<td><select class="easyui-combobox" name="cusEnterpriseExt.companyCapitalCurrency" data-options="editable:false" style="width:150px;">
													<option selected value="0">人民币</option>
													<option value="1">美元</option>
													<option value="2">欧元</option>
													<option value="3">英镑</option>
											</select></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">营业期限开始日期</td>
											<td><input type="text" class="easyui-datebox" name="cusEnterpriseExt.companyTermStartDate" value="" placeholder="YYYY-MM-DD" data-options="formatter:myformatter,parser:myparser,editable:false"></td>
											<td width="20%" class="tableleft">营业期限结束日期</td>
											<td><input type="text" class="easyui-datebox" name="cusEnterpriseExt.companyTermEndDate" value="" placeholder="YYYY-MM-DD" data-options="formatter:myformatter,parser:myparser,editable:false"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">工商登记机关</td>
											<td><input type="text" name="cusEnterpriseExt.companyRegOffice" value="" class="easyui-textbox"></td>
											<td width="20%" class="tableleft">发照日期</td>
											<td><input type="text" name="cusEnterpriseExt.companyDateOfIssue" class="easyui-datebox" value="" placeholder="YYYY-MM-DD" data-options="formatter:myformatter,parser:myparser,editable:false"></td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">公司规模</td>
											<td><select class="easyui-combobox" name="cusEnterpriseExt.companySize" data-options="editable:false" style="width:150px;">
														<option selected value="0">1-9人</option>
														<option value="1">10-49人</option>
														<option value="2">50-59人</option>
														<option value="3">100-499人</option>
														<option value="4">500以上</option>
											</select></td>
											<td width="20%" class="tableleft">所属行业</td>
											<td>
												<input class="easyui-combotree" name="cusEnterpriseExt.companyIndustry"  value="" data-options="url:'${ctxPath}/myCompany/myCompanyInfo/buildIndustryTree.html',method:'get'" style="width:159px;">
											</td>
										</tr>
										<tr>
											<td width="20%" class="tableleft">公司简介</td>
											<td colspan="3"><input class="easyui-textbox" name="remark" data-options="multiline:true" style="height:60px;width:600px;" value=""></input></td>										
										</tr>
										<tr>
											<td class="tableleft">公司经营范围</td>
											<td  colspan="3"><input class="easyui-textbox" name="cusEnterpriseExt.companyBusiness" data-options="multiline:true" style="height:60px;width:600px;" value=""></input></td>																				
										</tr>
									</tbody></table>
										<center style="border-top: 1px solid #ccc;">
											<a href="#" onclick="saveCusEnterprise()" class="easyui-linkbutton" data-options="iconCls:'icon-save'" style="padding:2px;margin-top: 10px;"> 保存 </a>
											<a href="${ctxPath}/myCompany/myEnterprise.html" class="easyui-linkbutton" data-options="iconCls:'icon-back'" style="padding:2px;margin-top: 10px;"> 返回 </a>
										</center>
									
								</form>
							</div>
						</div>
					</div>
				</div>
			</div>
		</div>
	</div>
</body>
</html>